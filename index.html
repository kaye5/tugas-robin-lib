<html>
    <head>
    <script type='text/javascript' src='library/solve.js'></script>
    <script type='text/javascript' src='library/map.js'></script>
    <script type='text/javascript' src='library/draw.js'></script>
        <script type='text/javascript' src='library/bfs.js'></script>
<!--    <script type='text/javascript' src='library/handler.js'></script>-->
    <link rel="stylesheet" type="text/css" href="style.css">
    </head>
    <body>
    
    <div>
        <p>Generate Map</p>
        <label>X : </label>
        <input type='number' name='number' id='input-x'>
        <br />
        <label>Y : </label>
        <input type='number' name='number' id='input-y'>
        <button onClick='generateMap()'>Generate Map</button>
    </div>
    <div>
        <p>Set Starting Point</p>
        <label>X : </label>
        <input type='number' name='number' id='starting-x'>
        <br />
        <label>Y : </label>
        <input type='number' name='number' id='starting-y'>
        <button onClick='setStartingPoint()'>Set</button>        
    </div>
        
    <div>
        <p>Set Final Point</p>
        <label>X : </label>
        <input type='number' name='number' id='final-x'>
        <br />
        <label>Y : </label>
        <input type='number' name='number' id='final-y'>
        <button onClick='setFinalPoint()'>Set</button>        
    </div>
        
    <div>
        <button onClick='findPath()'>Solve</button>
        <button onClick='reset()'>Reset</button>
    </div>
    <div id="map-output">
        
    </div>
    <script>
        
    </script>
    <script>
//        var myMaze = [
//        [1,1,1],
//        [1,1,1],
//        [1,1,2]
//        ];
//        a = new PathFinder(myMaze)
//        a.solve(0,0)
//        console.log(a.result())
        
        var map;
        var draw;
        var ms;
        var starting = {
            x : 0,
            y : 0,
        }
        var finalDest = {
            x  : 0,
            y : 0,
        }
        function generateMap(){
            let x = document.getElementById('input-x').value
            let y = document.getElementById('input-y').value
            map = new Map(x,y);
            map.generateEmptyMap();
            map.setFinalDest(x-1,y-1);
            finalDest = {
                x : x-1,y : y-1
            }
            draw = new Draw(map.getMap());
            draw.drawEmptyMap();
            document.getElementById(`output-0-0`).classList.add('starting')
        }
        function setStartingPoint(){
            let x = document.getElementById('starting-x').value
            let y = document.getElementById('starting-y').value
            document.getElementById(`output-${starting.x}-${starting.y}`).classList.remove('starting')
            starting.x = x-1
            starting.y = y-1
            document.getElementById(`output-${starting.x}-${starting.y}`).classList.add('starting')
        }
        function setFinalPoint(){
            let x = document.getElementById('final-x').value
            let y = document.getElementById('final-y').value
            map.updateFinalDest(finalDest.x,finalDest.y,x-1,y-1)
            document.getElementById(`output-${finalDest.x}-${finalDest.y}`).classList.remove('goal')
            finalDest.x = x-1
            finalDest.y = y-1
            document.getElementById(`output-${finalDest.x}-${finalDest.y}`).classList.add('goal')
        }
        function findPath(){
//                let start =  new Point(0,0)
//                let dest =  new Point(0,9)
//                console.log(bfs(map.getMap(),start,dest))
            ms = new PathFinder(map.getMap())
            ms.solve(starting.x,starting.y)
            let result = ms.result()
            
//            let count = 0;
//            let possibleSolution = { 0 : [] }
//            let minSol = [];
            
            for(let i = 0 ; i < result.length ;i++){
                let path = result[i]
                 document.getElementById(`output-${path.x}-${path.y}`).classList.add('active-path')
                if(path.finish)
                    break
                    
//                if(path.finish){
//                    if(possibleSolution[count].length < minSol.length || minSol.length == 0 )
//                        minSol = possibleSolution[count]
//                    count++;
//                    possibleSolution[count] = []
//                }
//                possibleSolution[count].push(path)
                    
            }
            
//            minSol.forEach(path=>{
//                    document.getElementById(`output-${path.x}-${path.y}`).classList.add('active-path')
//            })
        }
        function reset(){
            delete map;
            delete draw;
            delete ms;
            var output = document.getElementById('map-output')
            output.innerHTML = '';
            starting  ={
                x : 0,
                y : 0,
            }
        }
    </script>
    </body>
</html>